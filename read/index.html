<!DOCTYPE html>
<html>
    <head>
        <title>Blog posts by Tyler Robertson</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <style>
            :root {
                --bg: white;
                --text: black;
                --link: dodgerblue;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --bg: black;
                    --text: white;
                    --link: cornflowerblue;
                }
            }
            body {
                background-color: var(--bg);
            }
            main {
                width: 666px;
                max-width: 90vw;
                margin: 0 auto;
                font-family: serif;
                font-size: 130%;
                line-height: 130%;
                color: var(--text);
            }
            p {
                font-family: sans-serif;
            }
            a {
                color: var(--link);
            }
            h1 {
                font-size: 2.5em;
                line-height: 1em;
            }
            h1 a,
            h2 a,
            h3 a {
                color: var(--text);
                text-decoration: none;
            }
            hr {
                margin: 5rem;
            }
            footer {
                margin: 3rem 0;
                text-align: right;
            }
            img,
            iframe,
            video,
            canvas {
                margin: 1rem auto;
                max-width: 100%;
            }
        </style>
    </head>
    <body>
        <main>
            <h1>Blog posts by <a href="/">Tyler Robertson</a></h1>
        </main>
        <script async>
            const init = async () => {
                const xml = await fetch("./rss.xml");
                console.log(xml);
                const text = await xml.text();
                console.log(text);
                const posts = [
                    ...text.matchAll(/\<item\>(.+?)\<\/item\>/gi),
                ][0];
                console.log(posts);

                for (const post of posts) {
                    const article = document.createElement("article");
                    const a = document.createElement("a");
                    a.setAttribute(
                        "href",
                        /\<link\>(.+?)\<\/link\>/i.exec(post)
                    );
                    const h1 = document.createElement("h1");
                    h1.innerText = /\<title\>(.+?)\<\/title\>/i.exec(post);
                    a.appendChild(h1);
                    article.appendChild(a);
                    article.innerHTML += /\<\!\[CDATA\[(.+?)\]\]\>/i.exec(post);
                    document.querySelector("main").appendChild(article);
                }
            };

            init();
        </script>
    </body>
</html>
